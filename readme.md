# Description
* This repository contains all files necessary to run the analysis for my BSc thesis in **Brain & Cognition** at the Universtity of Amsterdam.
* The final report is included as a pdf file *BScThesis.pdf*

### Scope of the thesis
* The **research question** of this project is whether Parkinson's disease is related to a decrease of volume in the Medial Geniculate Nucleus of the thalamus
  * This was done by analyzing and comparing the MRI scans of people with and without Parkinson's disease
* Besides answering the research question, an additional purpose of the project was to use the MRI analyses as training data for an algorithm specifically tuned to automatically analyze MRI scans of human subcortical structures
  * The algorithm is called MASSP (Multi-contrast Anatomical Subcortical Structures Parcellation) and is described in [this](https://doi.org/10.7554/ELIFE.59430) article

## Instructions to run the code
* clone the repository from git
* open the dataProcessing.py file in an IDE with a python terminal * make sure the directory of the terminal is the BScThesisAnalysis folder
* in the python terminal type: pip install -r requirements.txt
  * this ensures that all the required libraries are installed in your environment
* in the python terminal type: jupyter notebook
* on the window that appears, click on the analysis.ipynb file
* once you are in the analysis.ipynb file, run every cell to reproduce the analysis

## Information on the files
This folder contains everything that is used for the final analysis.

In the folder "src" is the source code that I used to read process and analyze
the data. It should contain 4 python files and the subdirectory 
"BayesianMannWhitneyTest":
* **dataProcessing** --> \t  this file reads and processes the data
* **extras** --> contains a couple of functions that in the end were not used in the analysis
* **simulation** --> simulates data based on the sample mean and sd for 11, 15, 20, 30, 50, and 75 observations per group
* **visualizations** --> contains a couple of functions for boxplots and scatterplots
* **BayesianMannWhitneyTest** (the code is based on the source code of [JASP](https://github.com/jasp-stats/jaspTTests/blob/master/R/ttestbayesianindependentsamples.R) and on the article by [van Doorn et al., 2020](https://www.tandfonline.com/doi/full/10.1080/02664763.2019.1709053), on Bayesian rank-based hypothesis testing
  * gibbs.py
  * truncation.py
  * BayesFactorWilcoxon.py 
    * these 3 files are used to run the analysis: a Bayesian Mann Whitney U test

The demographic data and the volume data are in the inputData folder in excel files.

The volume data that I used for the analysis are in "inputData/volumeData".

These files were generated by the code to estimate the volume from the MRI delineations. 
	- The code for this is in "linuxEnvCode/get_volume.py".
	- This code only runs in a linux environment and needs the libraries 
	  "nighres" and "nibabel"
	- This code is adapted from the code of senior staff members of the IMCN unit at the UvA.

My MRI delineations are located in "inputData/mri_delineations"

The folder outputData contains the intermediate and final data, on which the analysis is run.

The folder results contains two csv files
	- result.csv with the results of the analysis
	- simulatedBFs.csv with the results of the analysis on the simulated data

The analysis.ipynb is a jupyter notebook file, in which I run the src code.

The requirements.txt file contains all the required libraries for the code to run.

The "boxplots_MGN_vol.png" is a picture of the boxplots with the MGN volume for each group.

The "scatterPlots_AgeVol.png" is a picture of the scatterplots for age and MGN volume for each group
